
@{
    Layout = null;
    string psnsname = (string)TempData["snsname"];
    string ptext = (string)TempData["pagedesc"];
    int ptype = (int)TempData["ptype"];
}

<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="P3P" content='CP="IDC DSP COR CURa ADMa  OUR IND PHY ONL COM STA"'>
    <link href="~/Content/H5share.min.css" rel="stylesheet" />
    <link href="~/fonts/iconfont.css" rel="stylesheet" />
    <script src="/Scripts/jquery-1.10.2.min.js"></script>

</head>
<body>
   @if (ptype == 0)
   {
        <div>
        @using (Html.BeginForm("OnSubmit", "Share", FormMethod.Post))
        {
            <div class="qr_sina" style="display:block">
                <div class="content">
                    <h2>分享 @psnsname </h2>
                    <div class="text in-s-text">
                        <textarea name="txbShare"></textarea>
                    </div>
                    <div class="text_num">
                        <p>还可以输入<span  class="charsLeft">200</span>字</p>
                    </div>
                    <div class="checked">
                        <div class="attention">
                            <input type="checkbox" checked="checked" name="cbfollow"/>
                            <label>是否关注飞利浦中国</label>
                        </div>
                        <div class="consent">
                            <input type="checkbox" name="cbMember" checked="checked"/>
                            <label>同意成为飞利浦官方网站会员</label>
                        </div>
                    </div>

                    <div class="btn">
                        <input class="btn_share" type="submit" value="分享" name="submitshare"/>
                    </div>
                </div>
            </div>
        }

    </div>
        }
    else if (ptype == 1)
        {
       <div class="success_failure">
            <div class="success">
                <div class="success_content" style="padding-top:100px;">
                    <i></i>
                    <h2 class="iconfont icon-duigou1">分享成功</h2>
                </div>
                <p class="time">页面将会在3秒后自动关闭</p>
            </div>
        </div>
    }
        else
        {
        <div class="success_failure">
            <div class="failure">
                <div class="failure_content" style="padding-top:100px;">
                    <i></i>
                    <h2 class="iconfont icon-cuowu1">分享失败</h2>
                </div>
                <p class="time">页面将会在3秒后自动关闭</p>
            </div>
        </div>
     }
 



    <script type="text/javascript">

        $(function () {

            var limitnum = 140;
            var text = $(".in-s-text textarea").val();
            var counter = text.length;
            if ((limitnum - counter) <= 0) {
                var num = $(".in-s-text textarea").val().substr(0, limitnum);
                $(".in-s-text textarea").val(num);
                $(".charsLeft").text(0);
            }
            $(".charsLeft").text(limitnum - counter);
            $(document).keyup(function () {
                var text = $(".in-s-text textarea").val();
                var counter = text.length;
                if ((limitnum - counter) <= 0) {
                    var num = $(".in-s-text textarea").val().substr(0, limitnum);
                    $(".in-s-text textarea").val(num);
                    $(".charsLeft").text(0);
                } else {
                    $(".charsLeft").text(limitnum - counter);
                }
            });
            $('.in-s-shareimgbtn').find('a').bind("click", function () {
                $(this).toggleClass("on");
                $('.in-s-shareimg').toggle();
                if ($('.in-s-shareimg').css("display") == "none") {
                    $("input[name=hdimg]").attr("value", "");
                } else {
                    $("input[name=hdimg]").attr("value", $(".in-s-shareimg .ok").find("img").attr("src"));
                }
                //alert($("input[name=hdimg]").attr("value"));
            });
           /* $('.in-s-shareimg').find('a').live("click", function () {
                $('.in-s-shareimg').find('a').removeClass();
                $(this).addClass("ok");
                $("input[name=hdimg]").attr("value", $(this).find("img").attr("src"));
                //alert("11" + $("input[name=hdimg]").attr("value"));
            })*/


            $("a").bind("focus", function () {
                if (this.blur) { this.blur() };
            });

            var url = window.location.href;
            var thiscs = url.split('?');
            var thisqs = "";
            for (k = 0; k < thiscs.length; k++) {
                if (k != 0) {
                    thisqs = thisqs + thiscs[k];
                }
            }
            $(".in-s-shareimgbtn,.in-s-shareimg").hide(); //最多分享5张图片
            if (thisqs) {
                var pairs = thisqs.split('&');
                for (i = 0; i < pairs.length; i++) {
                    var pair = pairs[i].split('=');
                    if (pair[0] == "shareimg" && pair[1] != "") {
                        var showimgs = pair[1].split(';');
                        //alert();
                        for (j = 0; j < showimgs.length; j++) {
                            var unitimg = showimgs[j].split(',');
                            $("<a>").attr("href", "javascript:void(0);").append($("<span>")).append($("<img>").attr("src", decodeURIComponent(unitimg[0])).attr("width", (unitimg[1] >= 1) ? "90" : Math.floor(unitimg[1] * 90)).attr("height", (unitimg[1] >= 1) ? Math.floor(90 / unitimg[1]) : "90").css("margin-top", (unitimg[1] >= 1) ? (90 - Math.floor(90 / unitimg[1])) / 2 : "0"))
                                .appendTo($(".in-s-shareimg"));
                        }
                        $(".in-s-shareimg").find("a:first").addClass("ok");
                        $(".in-s-shareimgbtn,.in-s-shareimg").show();
                        $("input[name=hdimg]").attr("value", $(".in-s-shareimg .ok").find("img").attr("src"));
                    }
                }
            }
        });
    </script>
    </body>
</html>
